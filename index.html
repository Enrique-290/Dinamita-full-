
<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DIN√ÅMITA POS ‚Äî Cat√°logo compacto</title>
<style>
  :root{
    --rojo:#dc2626;
    --negro:#111827;
    --gris:#f3f4f6;
    --borde:#e5e7eb;
    --morado:#6d28d9;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,sans-serif;background:#fff;color:#111}
  header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--borde);z-index:10}
  .top{display:flex;align-items:center;gap:12px;padding:12px 16px}
  .logo{width:36px;height:36px;border-radius:8px;background:var(--negro);display:grid;place-items:center;color:#fff;font-weight:700}
  .brand{font-weight:800;letter-spacing:.5px}
  .pill{margin-left:auto;font-size:12px;color:var(--rojo);font-weight:700}
  .search{padding:8px 16px;display:flex;gap:12px}
  .search input{flex:1;padding:10px 12px;border:1px solid var(--borde);border-radius:10px}
  .wrap{max-width:1100px;margin:0 auto;padding:12px 16px 96px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:14px}
  .card{border:1px solid var(--borde);border-radius:14px;padding:10px;display:flex;flex-direction:column;align-items:center;gap:8px;transition:box-shadow .15s}
  .card:hover{box-shadow:0 6px 20px rgba(0,0,0,.06)}
  .thumb{width:96px;height:96px;object-fit:contain}
  .name{font-size:13px;font-weight:600;text-align:center;min-height:34px}
  .price{font-size:13px;color:#111;font-weight:700}
  .btn{cursor:pointer;background:var(--morado);color:#fff;border:none;border-radius:10px;padding:8px 10px;width:100%;font-weight:700}
  .btn:active{transform:scale(.98)}
  /* cart bar */
  .bar{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid var(--borde);padding:10px 12px;display:flex;align-items:center;gap:10px}
  .bar .total{margin-left:auto;font-weight:800}
  .bar .final{background:var(--rojo)}
  .cart-panel{position:fixed;left:0;right:0;bottom:56px;background:#fff;border-top:1px solid var(--borde);max-height:40vh;overflow:auto;display:none}
  .cart-row{display:grid;grid-template-columns:30px 1fr 80px 90px;align-items:center;padding:10px 12px;border-bottom:1px solid var(--borde)}
  .qtybtn{width:28px;height:28px;border:1px solid var(--borde);border-radius:8px;background:#fff}
  .trash{border:1px solid var(--borde);border-radius:8px;padding:6px 8px;background:#fff;margin-left:6px}
  .muted{color:#6b7280;font-size:12px}
  dialog::backdrop{background:rgba(0,0,0,.35)}
  dialog{border:none;border-radius:16px;padding:0;max-width:520px;width:92%}
  .ticket{padding:18px 18px 10px}
  .ticket h3{margin:0 0 8px 0}
  .trow{display:grid;grid-template-columns:1fr 90px;gap:8px;padding:6px 0;border-bottom:1px dashed var(--borde)}
  .actions{display:flex;gap:8px;justify-content:flex-end;padding:10px 16px 16px}
  .secondary{background:#111827;color:#fff}
  .small{font-size:12px}
</style>
</head>
<body>
  <header>
    <div class="top">
      <div class="logo">üí•</div>
      <div class="brand">DIN√ÅMITA <span style="color:var(--rojo)">POS</span></div>
      <div class="pill">Modo Seguro (sin impresora)</div>
    </div>
    <div class="search">
      <input id="query" placeholder="Buscar producto por nombre o SKU...">
    </div>
  </header>

  <div class="wrap">
    <div id="grid" class="grid"></div>
  </div>

  <div id="cartPanel" class="cart-panel"></div>
  <div class="bar">
    <button id="toggleCart" class="btn secondary small">Ver carrito</button>
    <select id="metodo">
      <option>Efectivo</option>
      <option>Tarjeta</option>
      <option>Transferencia</option>
    </select>
    <div class="total">$<span id="total">0.00</span></div>
    <button id="finalBtn" class="btn final">Finalizar venta</button>
  </div>

  <dialog id="dlg">
    <div class="ticket">
      <h3>DIN√ÅMITA GYM ‚Äî Ticket</h3>
      <div class="muted small" id="ticketMeta"></div>
      <div id="ticketRows"></div>
      <div class="trow" style="font-weight:800"><div>Total</div><div id="ticketTotal" style="text-align:right"></div></div>
      <div class="muted small" style="padding-top:8px">Gracias por tu compra üí•</div>
    </div>
    <div class="actions">
      <button id="shareBtn" class="btn small">Compartir total</button>
      <button id="closeBtn" class="btn secondary small">Cerrar</button>
    </div>
  </dialog>

<script>
const productos = [
  {sku:"0237433", nombre:"Agua Bonafont 1L", precio:14, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect x='45' y='10' width='30' height='18' rx='4' fill='#0ea5e9'/>  <rect x='36' y='28' width='48' height='110' rx='8' fill='#93c5fd'/>  <rect x='36' y='65' width='48' height='5' fill='#60a5fa' />  <rect x='36' y='95' width='48' height='5' fill='#60a5fa' /></svg>"},
  {sku:"758104000159", nombre:"Agua Bonafont 2L", precio:20, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect x='45' y='10' width='30' height='18' rx='4' fill='#0ea5e9'/>  <rect x='36' y='28' width='48' height='110' rx='8' fill='#93c5fd'/>  <rect x='36' y='65' width='48' height='5' fill='#60a5fa' />  <rect x='36' y='95' width='48' height='5' fill='#60a5fa' /></svg>"},
  {sku:"758104005796", nombre:"Agua Bonafont 1.5L", precio:16, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect x='45' y='10' width='30' height='18' rx='4' fill='#0ea5e9'/>  <rect x='36' y='28' width='48' height='110' rx='8' fill='#93c5fd'/>  <rect x='36' y='65' width='48' height='5' fill='#60a5fa' />  <rect x='36' y='95' width='48' height='5' fill='#60a5fa' /></svg>"},
  {sku:"036171310649", nombre:"Gatorade 600ml", precio:20, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect x='45' y='10' width='30' height='18' rx='4' fill='#0ea5e9'/>  <rect x='36' y='28' width='48' height='110' rx='8' fill='#93c5fd'/>  <rect x='36' y='65' width='48' height='5' fill='#60a5fa' />  <rect x='36' y='95' width='48' height='5' fill='#60a5fa' /></svg>"},
  {sku:"0237433A", nombre:"Gatorade 1L", precio:26, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect x='45' y='10' width='30' height='18' rx='4' fill='#0ea5e9'/>  <rect x='36' y='28' width='48' height='110' rx='8' fill='#93c5fd'/>  <rect x='36' y='65' width='48' height='5' fill='#60a5fa' />  <rect x='36' y='95' width='48' height='5' fill='#60a5fa' /></svg>"},
  {sku:"7503027753", nombre:"Volt Blue", precio:22, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect width='80' height='140' x='20' y='10' rx='12' fill='#1f2937'/>  <rect width='80' height='18' x='20' y='10' rx='9' fill='#374151'/>  <text x='60' y='92' font-size='24' fill='#ffffff' text-anchor='middle' font-family='Arial'>VOLT</text></svg>"},
  {sku:"7503027753Y", nombre:"Volt Yellow", precio:22, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect width='80' height='140' x='20' y='10' rx='12' fill='#1f2937'/>  <rect width='80' height='18' x='20' y='10' rx='9' fill='#374151'/>  <text x='60' y='92' font-size='24' fill='#ffffff' text-anchor='middle' font-family='Arial'>VOLT</text></svg>"},
  {sku:"7503027753P", nombre:"Volt Pink", precio:22, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect width='80' height='140' x='20' y='10' rx='12' fill='#1f2937'/>  <rect width='80' height='18' x='20' y='10' rx='9' fill='#374151'/>  <text x='60' y='92' font-size='24' fill='#ffffff' text-anchor='middle' font-family='Arial'>VOLT</text></svg>"},
  {sku:"ELECTROLIT", nombre:"Electrolit", precio:25, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect x='45' y='10' width='30' height='18' rx='4' fill='#0ea5e9'/>  <rect x='36' y='28' width='48' height='110' rx='8' fill='#93c5fd'/>  <rect x='36' y='65' width='48' height='5' fill='#60a5fa' />  <rect x='36' y='95' width='48' height='5' fill='#60a5fa' /></svg>"},
  {sku:"TPW", nombre:"T Prote√≠na Whey", precio:25, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect x='20' y='30' width='80' height='110' rx='10' fill='#111827'/>  <rect x='20' y='20' width='80' height='20' rx='6' fill='#374151'/>  <text x='60' y='90' font-size='18' fill='#ef4444' text-anchor='middle' font-family='Arial'>PRO</text></svg>"},
  {sku:"TPM", nombre:"T Prote√≠na Mass", precio:35, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='160' viewBox='0 0 120 160'>  <rect x='20' y='30' width='80' height='110' rx='10' fill='#111827'/>  <rect x='20' y='20' width='80' height='20' rx='6' fill='#374151'/>  <text x='60' y='90' font-size='18' fill='#ef4444' text-anchor='middle' font-family='Arial'>PRO</text></svg>"},
  {sku:"BARRA", nombre:"Deli barras", precio:25, img:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='160' height='120' viewBox='0 0 160 120'>  <rect x='10' y='40' width='140' height='40' rx='8' fill='#f59e0b'/>  <rect x='10' y='40' width='30' height='40' rx='8' fill='#e11d48'/>  <rect x='120' y='40' width='30' height='40' rx='8' fill='#e11d48'/>  <text x='80' y='67' font-size='16' fill='#111827' text-anchor='middle' font-family='Arial'>BARRA</text></svg>"}
];

const grid = document.getElementById('grid');
const query = document.getElementById('query');
const cartPanel = document.getElementById('cartPanel');
const totalEl = document.getElementById('total');
const dlg = document.getElementById('dlg');
const ticketRows = document.getElementById('ticketRows');
const ticketTotal = document.getElementById('ticketTotal');
const ticketMeta = document.getElementById('ticketMeta');

let carrito = []; // { sku, nombre, precio, cant }

function renderGrid(list){
  grid.innerHTML = '';
  list.forEach(p => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <img class="thumb" alt="" src="${p.img}">
      <div class="name">${p.nombre}</div>
      <div class="price">$${p.precio.toFixed(2)} MXN</div>
      <button class="btn">Agregar</button>
    `;
    card.querySelector('.btn').onclick = () => addToCart(p);
    grid.appendChild(card);
  });
}

function addToCart(prod){
  const i = carrito.findIndex(x => x.sku === prod.sku);
  if(i>=0) carrito[i].cant += 1;
  else carrito.push({sku:prod.sku,nombre:prod.nombre,precio:prod.precio,cant:1});
  refreshCart();
}

function refreshCart(){
  cartPanel.style.display = carrito.length ? 'block':'none';
  cartPanel.innerHTML = '';
  let sum = 0;
  carrito.forEach(item => {
    sum += item.precio * item.cant;
    const row = document.createElement('div');
    row.className = 'cart-row';
    row.innerHTML = `
      <div>${item.cant}√ó</div>
      <div>${item.nombre}</div>
      <div style="text-align:right">$${(item.precio*item.cant).toFixed(2)}</div>
      <div style="text-align:right">
        <button class="qtybtn" aria-label="menos">-</button>
        <button class="qtybtn" aria-label="mas">+</button>
        <button class="trash" aria-label="borrar">üóëÔ∏è</button>
      </div>`;
    const [menos, mas, borrar] = row.querySelectorAll('button');
    menos.onclick = () => { item.cant = Math.max(0,item.cant-1); if(item.cant===0) remove(item.sku); refreshCart(); };
    mas.onclick = () => { item.cant += 1; refreshCart(); };
    borrar.onclick = () => { remove(item.sku); refreshCart(); };
    cartPanel.appendChild(row);
  });
  totalEl.textContent = sum.toFixed(2);
}

function remove(sku){ carrito = carrito.filter(x => x.sku !== sku); }

document.getElementById('toggleCart').onclick = () => {
  cartPanel.style.display = (cartPanel.style.display==='none' || !cartPanel.style.display) ? 'block' : 'none';
};

query.addEventListener('input', e => {
  const q = e.target.value.trim().toLowerCase();
  const list = productos.filter(p => 
     p.nombre.toLowerCase().includes(q) || p.sku.toLowerCase().includes(q));
  renderGrid(list);
});

document.getElementById('finalBtn').onclick = () => {
  if(!carrito.length) return;
  // render ticket
  ticketRows.innerHTML = '';
  let sum = 0;
  carrito.forEach(i => {
    const tr = document.createElement('div');
    tr.className = 'trow';
    tr.innerHTML = `<div>${i.cant}√ó ${i.nombre}</div><div style="text-align:right">$${(i.cant*i.precio).toFixed(2)}</div>`;
    ticketRows.appendChild(tr);
    sum += i.cant*i.precio;
  });
  ticketTotal.textContent = '$' + sum.toFixed(2);
  const dt = new Date();
  ticketMeta.textContent = dt.toLocaleString('es-MX') + ' ¬∑ ' + document.getElementById('metodo')?.value;
  dlg.showModal();
};

document.getElementById('closeBtn').onclick = () => {
  dlg.close();
  // vaciar carrito despu√©s de cerrar ticket
  carrito = [];
  refreshCart();
};

document.getElementById('shareBtn').onclick = async () => {
  const total = totalEl.textContent;
  const texto = `DIN√ÅMITA GYM ‚Äî Total: $${total} MXN`;
  if(navigator.share) {
    try { await navigator.share({title:'Ticket', text:texto}); } catch(e){}
  } else {
    try { await navigator.clipboard.writeText(texto); alert('Total copiado'); } catch(e) { alert(texto); }
  }
};

// init
renderGrid(productos);
refreshCart();
</script>
</body>
</html>
