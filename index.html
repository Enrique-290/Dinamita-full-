
<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DIN√ÅMITA POS ‚Äî Live Cart Footer</title>
<style>
  :root{
    --bg:#ffffff; --text:#111; --muted:#6b7280; --brand:#d90416;
    --soft:#f3f4f6; --radius:14px;
  }
  *{box-sizing:border-box;}
  body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text);}
  header{display:flex;gap:12px;align-items:center;padding:14px 16px;border-bottom:1px solid #e5e7eb;position:sticky;top:0;background:#fff;z-index:10;}
  .logo{width:30px;height:30px;border-radius:8px;background:linear-gradient(135deg,#000,#222); position:relative;}
  .logo:after{content:""; position:absolute; inset:8px; background:#ffb703; clip-path:polygon(50% 0,60% 35%,100% 35%,68% 57%,79% 91%,50% 70%,21% 91%,32% 57%,0 35%,40% 35%);}
  h1{font-size:18px;margin:0;}
  .mode{color:#b91c1c;font-weight:700;font-size:12px;}
  main{padding:12px;}
  table{width:100%; border-collapse:collapse; background:#fff; border:1px solid #e5e7eb; border-radius:var(--radius); overflow:hidden;}
  th,td{padding:12px;border-bottom:1px solid #e5e7eb;text-align:left;}
  th{background:#fafafa;font-weight:600;color:#374151;}
  tr:last-child td{border-bottom:0;}
  .btn{background:#111;color:#fff;border:0;border-radius:12px;padding:8px 14px;cursor:pointer;}
  .btn.red{background:var(--brand);}
  .btn.ghost{background:#fff;color:#111;border:1px solid #e5e7eb;}
  .price{font-variant-numeric:tabular-nums;}
  /* Cart footer */
  .cartbar{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid #e5e7eb;
           box-shadow:0 -8px 20px rgba(0,0,0,.06);padding:10px 12px; z-index:30;}
  .cartwrap{display:flex;gap:12px;align-items:flex-start;max-width:1000px;margin:0 auto;}
  .cartlist{flex:1;max-height:150px;overflow:auto;border:1px solid #e5e7eb;border-radius:12px;background:#fafafa;}
  .cartrow{display:grid;grid-template-columns:1.3fr 80px 100px 30px;gap:8px;align-items:center;padding:8px 10px;border-bottom:1px solid #e5e7eb;}
  .cartrow:last-child{border-bottom:0;}
  .qty{display:flex;gap:6px;align-items:center;justify-content:flex-start;}
  .qty button{width:26px;height:26px;border-radius:9px;border:1px solid #e5e7eb;background:#fff;cursor:pointer;}
  .right{display:flex;gap:12px;align-items:center;}
  select{padding:8px 10px;border-radius:10px;border:1px solid #e5e7eb;background:#fff;}
  .total{font-weight:800;font-size:18px;}
  .pill{font-size:12px;color:#b91c1c;font-weight:700;}
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:18px;z-index:50;}
  .sheet{background:#fff;border-radius:16px;max-width:520px;width:100%;padding:18px;border:1px solid #e5e7eb;}
  .sheet h3{margin:0 0 10px 0;}
  .muted{color:#6b7280;font-size:12px;}
</style>
</head>
<body>
<header>
  <div class="logo"></div>
  <div>
    <div style="font-weight:800;letter-spacing:.3px">DIN√ÅMITA <span style="color:var(--brand)">POS</span></div>
    <div class="pill">Modo Seguro (sin impresora)</div>
  </div>
</header>

<main>
  <h2 style="margin:8px 0 12px 0">Cat√°logo</h2>
  <table>
    <thead><tr><th>SKU</th><th>Producto</th><th>$</th><th>Stock</th><th></th></tr></thead>
    <tbody id="tbody"></tbody>
  </table>
  <p class="muted">Tip: toca ‚Äú+‚Äù en el carrito para aumentar cantidad; ‚Äú‚Äì‚Äù para disminuir; basurero para quitar.</p>
</main>

<!-- Cart footer -->
<div class="cartbar">
  <div class="cartwrap">
    <div class="cartlist" id="cartList"></div>
    <div class="right">
      <select id="pay">
        <option>Efectivo</option><option>Tarjeta</option><option>Transferencia</option>
      </select>
      <div class="total" id="total">$0.00</div>
      <button class="btn red" id="checkout">Finalizar venta</button>
    </div>
  </div>
</div>

<!-- Ticket modal -->
<div class="modal" id="modal">
  <div class="sheet">
    <h3>DIN√ÅMITA GYM ‚Äî Ticket</h3>
    <div class="muted">Modo seguro: impresi√≥n desactivada. Puedes compartir el total o cerrar.</div>
    <div id="ticket"></div>
    <div style="display:flex;gap:10px;margin-top:14px;justify-content:flex-end">
      <button class="btn ghost" id="close">Cerrar</button>
    </div>
  </div>
</div>

<script>
const fmt = n => n.toLocaleString('es-MX',{style:'currency',currency:'MXN'});

const products = [
  {sku:'758104001972', name:'Agua Bonafont 1L', price:14, stock:20},
  {sku:'758104000159', name:'Agua Bonafont 2L', price:20, stock:20},
  {sku:'758104005796', name:'Agua Bonafont 1.5L', price:16, stock:20},
  {sku:'0237433', name:'Gatorade 1L', price:26, stock:20},
  {sku:'037617310649', name:'Gatorade 600ml', price:20, stock:20},
  {sku:'7503027753', name:'Volt Blue', price:22, stock:20},
  {sku:'7503027753Y', name:'Volt Yellow', price:22, stock:20},
  {sku:'7503027753P', name:'Volt Pink', price:22, stock:20},
  {sku:'ELECTROLIT', name:'Electrolit', price:25, stock:20},
  {sku:'TPW', name:'T Prote√≠na Whey', price:25, stock:20},
  {sku:'TPM', name:'T Prote√≠na Mass', price:35, stock:20},
  {sku:'OX', name:'√ìxido', price:25, stock:20},
];

const tbody = document.getElementById('tbody');
products.forEach(p=>{
  const tr = document.createElement('tr');
  tr.innerHTML = \`
    <td>\${p.sku}</td>
    <td>\${p.name}</td>
    <td class="price">\${fmt(p.price)}</td>
    <td>\${p.stock}</td>
    <td><button class="btn" data-sku="\${p.sku}">Agregar</button></td>
  \`;
  tbody.appendChild(tr);
});

const cart = new Map(); // sku -> {sku,name,price,qty}
function renderCart(){
  const list = document.getElementById('cartList');
  list.innerHTML = '';
  let total = 0;
  if(cart.size===0){
    list.innerHTML = '<div class="cartrow" style="grid-template-columns:1fr"><span class="muted">El carrito est√° vac√≠o</span></div>';
  }else{
    cart.forEach(item=>{
      const row = document.createElement('div');
      const sub = item.qty * item.price;
      total += sub;
      row.className = 'cartrow';
      row.innerHTML = \`
        <div>\${item.name}</div>
        <div class="qty">
          <button data-act="dec" data-sku="\${item.sku}">‚Äì</button>
          <strong>\${item.qty}</strong>
          <button data-act="inc" data-sku="\${item.sku}">+</button>
        </div>
        <div class="price">\${fmt(sub)}</div>
        <div><button class="btn ghost" style="padding:4px 6px" data-act="del" data-sku="\${item.sku}">üóëÔ∏è</button></div>
      \`;
      list.appendChild(row);
    });
  }
  document.getElementById('total').textContent = fmt(total);
}
renderCart();

tbody.addEventListener('click', e=>{
  const btn = e.target.closest('button[data-sku]');
  if(!btn) return;
  const sku = btn.dataset.sku;
  const p = products.find(x=>x.sku===sku);
  const x = cart.get(sku) || {...p, qty:0};
  x.qty += 1;
  cart.set(sku,x);
  renderCart();
});

document.getElementById('cartList').addEventListener('click', e=>{
  const t = e.target;
  const sku = t.dataset.sku;
  const act = t.dataset.act;
  if(!sku||!act) return;
  const x = cart.get(sku);
  if(!x) return;
  if(act==='inc') x.qty += 1;
  if(act==='dec') x.qty = Math.max(0, x.qty-1);
  if(act==='del' || x.qty===0) cart.delete(sku);
  else cart.set(sku,x);
  renderCart();
});

const modal = document.getElementById('modal');
document.getElementById('checkout').onclick = ()=>{
  let html = '<table style="width:100%;border-collapse:collapse">';
  html += '<tr><th style="text-align:left;padding:6px;border-bottom:1px solid #eee">Concepto</th><th style="text-align:right;padding:6px;border-bottom:1px solid #eee">$</th></tr>';
  let total=0;
  cart.forEach(it=>{
    const sub = it.qty*it.price; total+=sub;
    html += \`<tr><td style="padding:6px">\${it.name} √ó \${it.qty}</td><td style="text-align:right;padding:6px">\${fmt(sub)}</td></tr>\`;
  });
  html += \`<tr><td style="padding:6px;font-weight:700">Total</td><td style="text-align:right;padding:6px;font-weight:800">\${fmt(total)}</td></tr>\`;
  html += '</table>';
  document.getElementById('ticket').innerHTML = html;
  modal.style.display='flex';
  // reset cart after showing ticket, to avoid "quedarse trabado"
  cart.clear();
  renderCart();
};
document.getElementById('close').onclick = ()=> modal.style.display='none';
modal.addEventListener('click', e=>{ if(e.target===modal) modal.style.display='none'; });
</script>
</body>
</html>
